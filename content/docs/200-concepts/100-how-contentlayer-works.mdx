---
global_id: da5b2220
title: Contentlayer的工作原理
excerpt: Contentlayer是内容和代码之间的粘合剂。
---

Contentlayer 是内容和代码之间的粘合剂。

多年来，将您的网站代码与其内容分离是司空见惯的事。这使得内容编辑和开发更加高效，并且容易出现更少的错误。（谁能反对没有 bug 的代码呢？）

您网站的 _代码_ 通常构建在前端框架或静态站点生成器之上，例如[Gatsby](https://www.gatsbyjs.com/)或[Next.js](https://nextjs.org/)（以及许多其他）。而且 _内容_ 通常要么位于像[Contentful](https://www.contentful.com/)或[Sanity](https://www.sanity.io/)（也包括许多其他文件）这样的无头内容管理系统中，但也可以存储在本地文件中。

一些框架对应该如何将内容加载到代码中持不同意见。例如，Gatsby 拥有[一个庞大的插件市场](https://www.gatsbyjs.com/plugins)和[GraphQL 层](https://www.gatsbyjs.com/docs/graphql/)可以一起用于将内容加载到代码中。

像 Next.js 这样的其他框架对内容不采取任何立场，而是由你自己决定这就是 Contentlayer 的闪光点。

## Contentlayer 的三个方面

Contentlayer 有三种主要用途，每种用途都围绕着将内容转换为代码可以轻松使用的数据的主要目的。这些片段是：

- 将内容转换为数据
- 结构化松散数据
- 定义数据类型

## 将内容转换为数据

无论数据的来源或数据在代码中的使用方式如何，Contentlayer 的主要目的都是将内容转换为代码可以使用的数据。

这个过程是通过从数据源读取数据来实现的，无论数据源是外部文件还是一系列本地文件，并将其转换为代码可以理解的格式，即可导入的 JavaScript 文件。

这提供了一系列好处，但也许最大的好处是，您的内容突然被视为更多的代码，这使得像 Next.js 这样的框架很难识别您何时更新了内容，并几乎立即使用热模块重新加载（HMR）刷新 DOM。

## 结构化松散数据

当在外部数据源中定义数据时，该系统（几乎）总是要求数据附加一些*schema*。这意味着数据的结构是可预测的。因此，当您的内容源是外部的时，Contentlayer 已经知道该结构应该是什么，并相应地做出响应。

但是，当您使用本地文件时，没有将这些文件绑定到代码的固有结构。因此，如果你用一个文件更改内容，你很容易就会破坏网站的代码。

当使用本地文件作为数据源时，Contentlayer 提供了定义这些文件的模式的能力。这样，您就可以对数据的形状充满信心，并可以编写反映该形状的更坚实的代码。

## 定义数据类型

Contentlayer _顶部的樱桃_ 是为所有 TypeScript 粉丝准备的。当 Contentlayer 将内容转换为数据时，它还会为该数据创建类型定义。这意味着您可以内省代码中的内容结构。这可以为您提供一种只有通过编写程序测试才能真正匹配的信心水平。
